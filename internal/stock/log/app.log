time="2025-02-09T16:03:38+08:00" level=debug msg="dsn = root:root@tcp(localhost:3307)/gorder_v2?charset=utf8mb4&parseTime=True&loc=Local"
time="2025-02-09T16:03:38+08:00" level=info msg="register to consul" addr="127.0.0.1:5003" serviceName=stock
time="2025-02-09T16:03:38+08:00" level=info msg="Start gRPC server, Listening: 127.0.0.1:5003"
time="2025-02-09T16:04:04+08:00" level=info msg="_grpc_request_in" args=Items:{ID:"prod_RPmhK2nexllK3r"  Quantity:50}  Items:{ID:"prod_ROGERol0hYd3tx"  Quantity:97} hook_trace=5b6639e774041263e86dfa9a362d8587 metadata=MD{x-b3-spanid=[77ddf1eba042a0b5], x-b3-traceid=[5b6639e774041263e86dfa9a362d8587], x-b3-sampled=[1], :authority=[127.0.0.1:5003], content-type=[application/grpc], user-agent=[grpc-go/1.64.0], traceparent=[00-5b6639e774041263e86dfa9a362d8587-77ddf1eba042a0b5-01]}
time="2025-02-09T16:04:04+08:00" level=info msg="_redis_setnx_success" cost=1h25m14.542s error=<nil> hook_trace=5b6639e774041263e86dfa9a362d8587 key="check_stock_prod_RPmhK2nexllK3r_prod_ROGERol0hYd3tx" now=2025-02-09 16:04:04.857752 +0800 CST m=+25.937598626 value=1
time="2025-02-09T16:04:04+08:00" level=info msg="mysql_success" args="{"product_id":["prod_RPmhK2nexllK3r","prod_ROGERol0hYd3tx"]}" cost=9 hook_trace=5b6639e774041263e86dfa9a362d8587 method=BatchGetStockByID resp=[]
time="2025-02-09T16:04:04+08:00" level=info msg="mysql_success" args="{"product_id":["prod_RPmhK2nexllK3r","prod_ROGERol0hYd3tx"],"for_update":true}" cost=10 hook_trace=5b6639e774041263e86dfa9a362d8587 method=BatchGetStockByID resp=[]
time="2025-02-09T16:04:04+08:00" level=info msg="mysql_success" args="{"product_id":["prod_RPmhK2nexllK3r"],"quantity":[50]}" cost=4 hook_trace=5b6639e774041263e86dfa9a362d8587 method=Update resp={0  0 0 0001-01-01 00:00:00 +0000 UTC 0001-01-01 00:00:00 +0000 UTC}
time="2025-02-09T16:04:04+08:00" level=info msg="mysql_success" args="{"product_id":["prod_ROGERol0hYd3tx"],"quantity":[97]}" cost=1 hook_trace=5b6639e774041263e86dfa9a362d8587 method=Update resp={0  0 0 0001-01-01 00:00:00 +0000 UTC 0001-01-01 00:00:00 +0000 UTC}
time="2025-02-09T16:04:05+08:00" level=info msg="_redis_del_success" cost=18m35.334s error=<nil> hook_trace=5b6639e774041263e86dfa9a362d8587 key="check_stock_prod_RPmhK2nexllK3r_prod_ROGERol0hYd3tx" now=2025-02-09 16:04:05.60501 +0800 CST m=+26.684853709
time="2025-02-09T16:04:05+08:00" level=info msg="Query executed successfully" hook_trace=5b6639e774041263e86dfa9a362d8587 query=CheckIfItemsInStock query_body="{"Items":[{"ID":"prod_RPmhK2nexllK3r","Quantity":50},{"ID":"prod_ROGERol0hYd3tx","Quantity":97}]}"
time="2025-02-09T16:04:05+08:00" level=info msg="finished unary call with code OK" grpc.code=OK grpc.method=CheckIfItemsInStock grpc.service=stockpb.StockService grpc.start_time="2025-02-09T16:04:04+08:00" grpc.time_ms=749.821 hook_trace=5b6639e774041263e86dfa9a362d8587 peer.address="127.0.0.1:54074" span.kind=server system=grpc
15:57:16+08:00" grpc.time_ms=19.727 hook_trace=a88c0547e67077ca1e1d874a80031ac3 peer.address="127.0.0.1:53342" span.kind=server system=grpc

rt_time="2025-02-09T14:57:37+08:00" grpc.time_ms=36.548 hook_trace=11d81e802c1555ffa20369063265f68b peer.address="127.0.0.1:59619" span.kind=server system=grpc
time="2025-02-09T15:15:17+08:00" level=info msg="_grpc_request_in" args=Items:{ID:"prod_RPmhK2nexllK3r" Quantity:50} Items:{ID:"prod_ROGERol0hYd3tx" Quantity:97} hook_trace=766c54027e6335cf5b3bb80c785aadf7 metadata=MD{x-b3-sampled=[1], x-b3-spanid=[38d8ee08be57e134], :authority=[127.0.0.1:5003], content-type=[application/grpc], user-agent=[grpc-go/1.64.0], traceparent=[00-766c54027e6335cf5b3bb80c785aadf7-38d8ee08be57e134-01], x-b3-traceid=[766c54027e6335cf5b3bb80c785aadf7]}
time="2025-02-09T15:15:17+08:00" level=debug msg="Executing query" query=CheckIfItemsInStock query_body="{"Items":[{"ID":"prod_RPmhK2nexllK3r","Quantity":50},{"ID":"prod_ROGERol0hYd3tx","Quantity":97}]}"
time="2025-02-09T15:15:17+08:00" level=info msg="_redis_setnx_success" cost=3h22m43.25s error=<nil> hook_trace=766c54027e6335cf5b3bb80c785aadf7 key="check_stock_prod_RPmhK2nexllK3r_prod_ROGERol0hYd3tx" now=2025-02-09 15:15:17.473082 +0800 CST m=+1145.083460751 value=1
time="2025-02-09T15:15:17+08:00" level=info msg="mysql_success" args="{"product_id":["prod_RPmhK2nexllK3r","prod_ROGERol0hYd3tx"]}" cost=143 hook_trace=766c54027e6335cf5b3bb80c785aadf7 method=BatchGetStockByID resp=[]
time="2025-02-09T15:15:17+08:00" level=info msg="mysql_success" args="{"product_id":["prod_RPmhK2nexllK3r","prod_ROGERol0hYd3tx"],"for_update":true}" cost=0 hook_trace=766c54027e6335cf5b3bb80c785aadf7 method=BatchGetStockByID resp=[]
time="2025-02-09T15:15:17+08:00" level=warning msg="update stock transaction err, err="
time="2025-02-09T15:15:17+08:00" level=info msg="_redis_del_success" cost=7m1.792s error=<nil> hook_trace=766c54027e6335cf5b3bb80c785aadf7 key="check_stock_prod_RPmhK2nexllK3r_prod_ROGERol0hYd3tx" now=2025-02-09 15:15:17.63218 +0800 CST m=+1145.242557876
time="2025-02-09T15:15:17+08:00" level=error msg="Failed to execute query,err=" query=CheckIfItemsInStock query_body="{"Items":[{"ID":"prod_RPmhK2nexllK3r","Quantity":50},{"ID":"prod_ROGERol0hYd3tx","Quantity":97}]}"
time="2025-02-09T15:15:17+08:00" level=error msg="_grpc_request_out" args=Items:{ID:"prod_RPmhK2nexllK3r" Quantity:50} Items:{ID:"prod_ROGERol0hYd3tx" Quantity:97} error="rpc error: code = Internal desc = " hook_trace=766c54027e6335cf5b3bb80c785aadf7 metadata=MD{x-b3-spanid=[38d8ee08be57e134], :authority=[127.0.0.1:5003], content-type=[application/grpc], user-agent=[grpc-go/1.64.0], traceparent=[00-766c54027e6335cf5b3bb80c785aadf7-38d8ee08be57e134-01], x-b3-traceid=[766c54027e6335cf5b3bb80c785aadf7], x-b3-sampled=[1]} resp=<nil>
time="2025-02-09T15:15:17+08:00" level=error msg="finished unary call with code Internal" error="rpc error: code = Internal desc = " grpc.code=Internal grpc.method=CheckIfItemsInStock grpc.service=stockpb.StockService grpc.start_time="2025-02-09T15:15:17+08:00" grpc.time_ms=164.834 hook_trace=766c54027e6335cf5b3bb80c785aadf7 peer.address="127.0.0.1:62810" span.kind=server system=grpc
time="2025-02-09T15:24:26+08:00" level=info msg="_grpc_request_in" args=Items:{ID:"prod_ROGERol0hYd3tx" Quantity:97} Items:{ID:"prod_RPmhK2nexllK3r" Quantity:50} hook_trace=0c697d8f1c99f008f1d1392921b74142 metadata=MD{content-type=[application/grpc], x-b3-spanid=[c91787cb8eb662b3], x-b3-sampled=[1], user-agent=[grpc-go/1.64.0], traceparent=[00-0c697d8f1c99f008f1d1392921b74142-c91787cb8eb662b3-01], x-b3-traceid=[0c697d8f1c99f008f1d1392921b74142], :authority=[127.0.0.1:5003]}
time="2025-02-09T15:24:26+08:00" level=debug msg="Executing query" query=CheckIfItemsInStock query_body="{"Items":[{"ID":"prod_ROGERol0hYd3tx","Quantity":97},{"ID":"prod_RPmhK2nexllK3r","Quantity":50}]}"
time="2025-02-09T15:24:26+08:00" level=info msg="_redis_setnx_success" cost=2h38m56.541s error=<nil> hook_trace=0c697d8f1c99f008f1d1392921b74142 key="check_stock_prod_ROGERol0hYd3tx_prod_RPmhK2nexllK3r" now=2025-02-09 15:24:26.102095 +0800 CST m=+1693.710018543 value=1
time="2025-02-09T15:24:26+08:00" level=info msg="mysql_success" args="{"product_id":["prod_ROGERol0hYd3tx","prod_RPmhK2nexllK3r"]}" cost=28 hook_trace=0c697d8f1c99f008f1d1392921b74142 method=BatchGetStockByID resp=[]
time="2025-02-09T15:24:26+08:00" level=info msg="mysql_success" args="{"product_id":["prod_ROGERol0hYd3tx","prod_RPmhK2nexllK3r"],"for_update":true}" cost=0 hook_trace=0c697d8f1c99f008f1d1392921b74142 method=BatchGetStockByID resp=[]
time="2025-02-09T15:24:26+08:00" level=warning msg="update stock transaction err, err="
time="2025-02-09T15:24:26+08:00" level=info msg="_redis_del_success" cost=2m20.375s error=<nil> hook_trace=0c697d8f1c99f008f1d1392921b74142 key="check_stock_prod_ROGERol0hYd3tx_prod_RPmhK2nexllK3r" now=2025-02-09 15:24:26.142266 +0800 CST m=+1693.750190168
time="2025-02-09T15:24:26+08:00" level=error msg="Failed to execute query,err=" query=CheckIfItemsInStock query_body="{"Items":[{"ID":"prod_ROGERol0hYd3tx","Quantity":97},{"ID":"prod_RPmhK2nexllK3r","Quantity":50}]}"
time="2025-02-09T15:24:26+08:00" level=error msg="_grpc_request_out" args=Items:{ID:"prod_ROGERol0hYd3tx" Quantity:97} Items:{ID:"prod_RPmhK2nexllK3r" Quantity:50} error="rpc error: code = Internal desc = " hook_trace=0c697d8f1c99f008f1d1392921b74142 metadata=MD{user-agent=[grpc-go/1.64.0], traceparent=[00-0c697d8f1c99f008f1d1392921b74142-c91787cb8eb662b3-01], x-b3-traceid=[0c697d8f1c99f008f1d1392921b74142], :authority=[127.0.0.1:5003], content-type=[application/grpc], x-b3-spanid=[c91787cb8eb662b3], x-b3-sampled=[1]} resp=<nil>
time="2025-02-09T15:24:26+08:00" level=error msg="finished unary call with code Internal" error="rpc error: code = Internal desc = " grpc.code=Internal grpc.method=CheckIfItemsInStock grpc.service=stockpb.StockService grpc.start_time="2025-02-09T15:24:26+08:00" grpc.time_ms=41.125 hook_trace=0c697d8f1c99f008f1d1392921b74142 peer.address="127.0.0.1:64514" span.kind=server system=grpc
time="2025-02-09T15:28:59+08:00" level=info msg="_grpc_request_in" args=Items:{ID:"prod_RPmhK2nexllK3r" Quantity:50} Items:{ID:"prod_ROGERol0hYd3tx" Quantity:97} hook_trace=39ba134b63a1497756832a8743df6105 metadata=MD{x-b3-traceid=[39ba134b63a1497756832a8743df6105], x-b3-sampled=[1], user-agent=[grpc-go/1.64.0], traceparent=[00-39ba134b63a1497756832a8743df6105-4164d3122df886c3-01], x-b3-spanid=[4164d3122df886c3], :authority=[127.0.0.1:5003], content-type=[application/grpc]}
time="2025-02-09T15:28:59+08:00" level=debug msg="Executing query" query=CheckIfItemsInStock query_body="{"Items":[{"ID":"prod_RPmhK2nexllK3r","Quantity":50},{"ID":"prod_ROGERol0hYd3tx","Quantity":97}]}"
time="2025-02-09T15:28:59+08:00" level=info msg="_redis_setnx_success" cost=2h51m58.25s error=<nil> hook_trace=39ba134b63a1497756832a8743df6105 key="check_stock_prod_RPmhK2nexllK3r_prod_ROGERol0hYd3tx" now=2025-02-09 15:28:59.510892 +0800 CST m=+1967.117592751 value=1
time="2025-02-09T15:28:59+08:00" level=info msg="mysql_success" args="{"product_id":["prod_RPmhK2nexllK3r","prod_ROGERol0hYd3tx"]}" cost=26 hook_trace=39ba134b63a1497756832a8743df6105 method=BatchGetStockByID resp=[]
time="2025-02-09T15:28:59+08:00" level=info msg="mysql_success" args="{"product_id":["prod_RPmhK2nexllK3r","prod_ROGERol0hYd3tx"],"for_update":true}" cost=1 hook_trace=39ba134b63a1497756832a8743df6105 method=BatchGetStockByID resp=[]
time="2025-02-09T15:28:59+08:00" level=warning msg="update stock transaction err, err="
time="2025-02-09T15:28:59+08:00" level=info msg="_redis_del_success" cost=4m19s error=<nil> hook_trace=39ba134b63a1497756832a8743df6105 key="check_stock_prod_RPmhK2nexllK3r_prod_ROGERol0hYd3tx" now=2025-02-09 15:28:59.550461 +0800 CST m=+1967.157162293
time="2025-02-09T15:28:59+08:00" level=error msg="Failed to execute query,err=" query=CheckIfItemsInStock query_body="{"Items":[{"ID":"prod_RPmhK2nexllK3r","Quantity":50},{"ID":"prod_ROGERol0hYd3tx","Quantity":97}]}"
time="2025-02-09T15:28:59+08:00" level=error msg="_grpc_request_out" args=Items:{ID:"prod_RPmhK2nexllK3r" Quantity:50} Items:{ID:"prod_ROGERol0hYd3tx" Quantity:97} error="rpc error: code = Internal desc = " hook_trace=39ba134b63a1497756832a8743df6105 metadata=MD{content-type=[application/grpc], x-b3-traceid=[39ba134b63a1497756832a8743df6105], x-b3-sampled=[1], user-agent=[grpc-go/1.64.0], traceparent=[00-39ba134b63a1497756832a8743df6105-4164d3122df886c3-01], x-b3-spanid=[4164d3122df886c3], :authority=[127.0.0.1:5003]} resp=<nil>
time="2025-02-09T15:28:59+08:00" level=error msg="finished unary call with code Internal" error="rpc error: code = Internal desc = " grpc.code=Internal grpc.method=CheckIfItemsInStock grpc.service=stockpb.StockService grpc.start_time="2025-02-09T15:28:59+08:00" grpc.time_ms=40.864 hook_trace=39ba134b63a1497756832a8743df6105 peer.address="127.0.0.1:64514" span.kind=server system=grpc
